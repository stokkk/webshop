BEGIN;
--
-- Create model Attributes
--
CREATE TABLE "main_attributes" ("id" serial NOT NULL PRIMARY KEY, "title" varchar(50) NOT NULL, "slug" varchar(50) NOT NULL, "attribute_type" varchar(50) NOT NULL);
--
-- Create model Brand
--
CREATE TABLE "main_brand" ("id" serial NOT NULL PRIMARY KEY, "brand_name" varchar(100) NOT NULL);
--
-- Create model Categories
--
CREATE TABLE "main_categories" ("id" serial NOT NULL PRIMARY KEY, "name" varchar(100) NOT NULL);
--
-- Create model Product
--
CREATE TABLE "main_product" ("id" serial NOT NULL PRIMARY KEY, "name" varchar(200) NOT NULL, "date_of_receipt" timestamp with time zone NOT NULL, "sex" varchar(20) NOT NULL, "season" varchar(20) NOT NULL, "description" text NOT NULL, "brand_fk_id" integer NOT NULL, "category_fk_id" integer NOT NULL);
--
-- Create model ProductPhoto
--
CREATE TABLE "main_productphoto" ("id" serial NOT NULL PRIMARY KEY, "prodPhotoUrl" varchar(255) NOT NULL, "prodPhotoBin" bytea NOT NULL);
--
-- Create model Values
--
CREATE TABLE "main_values" ("id" serial NOT NULL PRIMARY KEY, "value" varchar(200) NOT NULL, "slug" varchar(50) NOT NULL, "attribute_fk_id" integer NOT NULL);
--
-- Create model ProductValue
--
CREATE TABLE "main_productvalue" ("id" serial NOT NULL PRIMARY KEY, "product_fk_id" integer NOT NULL, "product_value_fk_id" integer NOT NULL);
--
-- Add field product_photo_fk to product
--
ALTER TABLE "main_product" ADD COLUMN "product_photo_fk_id" integer NOT NULL CONSTRAINT "main_product_product_photo_fk_id_84156da9_fk_main_prod" REFERENCES "main_productphoto"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "main_product_product_photo_fk_id_84156da9_fk_main_prod" IMMEDIATE;
--
-- Create model AttributeAndCategory
--
CREATE TABLE "main_attributeandcategory" ("id" serial NOT NULL PRIMARY KEY, "attribute_fk_id" integer NOT NULL, "category_fk_id" integer NOT NULL);
ALTER TABLE "main_product" ADD CONSTRAINT "main_product_brand_fk_id_8091e9f9_fk_main_brand_id" FOREIGN KEY ("brand_fk_id") REFERENCES "main_brand" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "main_product" ADD CONSTRAINT "main_product_category_fk_id_ea7fa3ca_fk_main_categories_id" FOREIGN KEY ("category_fk_id") REFERENCES "main_categories" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "main_product_brand_fk_id_8091e9f9" ON "main_product" ("brand_fk_id");
CREATE INDEX "main_product_category_fk_id_ea7fa3ca" ON "main_product" ("category_fk_id");
ALTER TABLE "main_values" ADD CONSTRAINT "main_values_attribute_fk_id_0336e7f5_fk_main_attributes_id" FOREIGN KEY ("attribute_fk_id") REFERENCES "main_attributes" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "main_values_attribute_fk_id_0336e7f5" ON "main_values" ("attribute_fk_id");
ALTER TABLE "main_productvalue" ADD CONSTRAINT "main_productvalue_product_fk_id_41fade8b_fk_main_product_id" FOREIGN KEY ("product_fk_id") REFERENCES "main_product" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "main_productvalue" ADD CONSTRAINT "main_productvalue_product_value_fk_id_17269c83_fk_main_valu" FOREIGN KEY ("product_value_fk_id") REFERENCES "main_values" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "main_productvalue_product_fk_id_41fade8b" ON "main_productvalue" ("product_fk_id");
CREATE INDEX "main_productvalue_product_value_fk_id_17269c83" ON "main_productvalue" ("product_value_fk_id");
CREATE INDEX "main_product_product_photo_fk_id_84156da9" ON "main_product" ("product_photo_fk_id");
ALTER TABLE "main_attributeandcategory" ADD CONSTRAINT "main_attributeandcat_attribute_fk_id_0e5d9e09_fk_main_attr" FOREIGN KEY ("attribute_fk_id") REFERENCES "main_attributes" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "main_attributeandcategory" ADD CONSTRAINT "main_attributeandcat_category_fk_id_6bd1569a_fk_main_cate" FOREIGN KEY ("category_fk_id") REFERENCES "main_categories" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "main_attributeandcategory_attribute_fk_id_0e5d9e09" ON "main_attributeandcategory" ("attribute_fk_id");
CREATE INDEX "main_attributeandcategory_category_fk_id_6bd1569a" ON "main_attributeandcategory" ("category_fk_id");
COMMIT;
